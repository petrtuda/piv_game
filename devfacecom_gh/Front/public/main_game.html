<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–æ–≥—Ä–µ—Å—Å –ë–∞—Ä</title>
    <link rel="stylesheet" href="css/game_styles.css"> <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º CSS -->
</head>
<body>

<div class="frame">
    <div class="beer-count">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∏–≤–∞: <span id="beerCount">5</span> üç∫</div>
    <div class="dropdown">
        <select class="dropdown" id="beerSelect" onchange="updateBeerCount()">
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
        </select>
        <span class="emoji">üç∫</span>
    </div>
    <button class="play-button" onmouseover="showModal()">Start</button>
    <div class="progress-container">
        <div class="progress-bar">
            <div class="progress" id="progress"></div>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ -->
<div id="authModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <h2>–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</h2>
        <label for="username">–í–≤–µ–¥–∏—Ç–µ Username:</label>
        <input type="text" id="username" placeholder="–í–≤–µ–¥–∏—Ç–µ Username" />
        <button id="generateUsernameButton">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —é–∑–µ—Ä–Ω–µ–π–º</button>
        <br>
        <label for="password">–í–≤–µ–¥–∏—Ç–µ Password:</label>
        <input type="text" id="password" placeholder="–í–≤–µ–¥–∏—Ç–µ Password" />
        <button class="generate-button" onclick="generatePassword()">Generate</button>
        <br>
        <button class="go-button" onclick="closeModal()">Go</button> 
    </div>
</div>

<!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤–Ω–µ—à–Ω–µ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ -->
<script src="js/script.js" defer></script>
<script>
    const token = 'YOUR_GITLAB_ACCESS_TOKEN'; // –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à —Ç–æ–∫–µ–Ω
    const projectId = 'YOUR_PROJECT_ID'; // –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ ID –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞

    async function fetchPipelineStatus() {
        const response = await fetch(`https://gitlab.com/api/v4/projects/${projectId}/pipelines/latest`, {
            headers: {
                'Authorization': `Bearer ${token}`
            }
        });

        if (response.ok) {
            const data = await response.json();
            updateProgressBar(data.status);
        } else {
            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞:', response.statusText);
        }
    }

    function updateProgressBar(status) {
        const progressBar = document.getElementById('progressBar');
        let width = 0;

        switch (status) {
            case 'success':
                width = 100;
                progressBar.style.background = '#4caf50';
                break;
            case 'failed':
                width = 0;
                progressBar.style.background = '#f44336';
                break;
            case 'running':
                width = 50;
                progressBar.style.background = '#ff9800';
                break;
            case 'pending':
                width = 25;
                progressBar.style.background = '#2196f3';
                break;
            default:
                width = 0;
                break;
        }

        progressBar.style.width = `${width}%`;
        progressBar.innerText = `${status.charAt(0).toUpperCase() + status.slice(1)}`;
    }

    fetchPipelineStatus();
</script>
</body>
</html>